package tcp.stream;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;

import exceptions.ErrorException;

public class FileStreamer {
	
	int portNumber;
	String hostName = null;
	Socket streamSocket = null;
	PrintWriter outStream = null;
	TCPCommunication tcpcomm = null;
	
	//deprecated
	public void setPortNumber(int pn){
		portNumber = pn;
		
	}
	//deprecated
	public void setHostName(String hn){
		hostName = hn;
	}
	
	//deprecated
	public FileStreamer(String hn, int pn) throws UnknownHostException, IOException{
		hostName = hn;
		portNumber = pn;
		streamSocket = new Socket(hostName, portNumber);
		outStream = new PrintWriter(streamSocket.getOutputStream(), true);
	}
	
	public FileStreamer() throws ErrorException, UnknownHostException, IOException {
		
		if(hostName.isEmpty() || portNumber==0){
			System.out.println("Socket could not be created");
			throw new ErrorException("Wrong host name of port number");
		}
		else{
			streamSocket = new Socket(hostName, portNumber);
			outStream = new PrintWriter(streamSocket.getOutputStream(), true);
		}
		
	}
	
	public FileStreamer(TCPCommunication tcpcomm){
		hostName = tcpcomm.hostName;
		portNumber = tcpcomm.portNumber;
		streamSocket = tcpcomm.streamSocket;
		outStream = tcpcomm.outStream;
		
	}

	
	public boolean streamFile(File fd){

		outStream.println("TEST");
		return true;
	}
	
	private boolean isTransferSuccesfull() throws IOException{
		while(!tcpcomm.sendCommand(ControllCommands.testcommand));
		
		if(tcpcomm.receiveCommand().equals(ControllCommands.TRANSFER_SUCCESFULL))
			return true;
		else
			return false;
		
	}
	
}
